<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Migrating EKS Nodes from Amazon Linux 2 to Amazon Linux 2023 (AL2023) | Saurabh Cloud Page</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Learn how to migrate your EKS worker nodes from Amazon Linux 2 (AL2) to Amazon Linux 2023 (AL2023), set up custom launch templates, and handle IMDSv2 and IRSA configurations."><meta name=generator content="Hugo 0.154.1"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.d05fb5f317fcf33b3a52936399bdf6f47dc776516e1692e412ec7d76f4a5faa2.css><link rel=canonical href=https://saurabhoncloud.com/posts/eks-migration-amazon-linux-2023/><meta property="og:url" content="https://saurabhoncloud.com/posts/eks-migration-amazon-linux-2023/"><meta property="og:site_name" content="Saurabh Cloud Page"><meta property="og:title" content="Migrating EKS Nodes from Amazon Linux 2 to Amazon Linux 2023 (AL2023)"><meta property="og:description" content="Learn how to migrate your EKS worker nodes from Amazon Linux 2 (AL2) to Amazon Linux 2023 (AL2023), set up custom launch templates, and handle IMDSv2 and IRSA configurations."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-11T10:00:00+05:30"><meta property="article:modified_time" content="2025-11-11T10:00:00+05:30"><meta property="article:tag" content="AWS"><meta property="article:tag" content="EKS"><meta property="article:tag" content="DevOps"><meta property="article:tag" content="Amazon Linux 2023"><meta property="article:tag" content="Kubernetes"><meta itemprop=name content="Migrating EKS Nodes from Amazon Linux 2 to Amazon Linux 2023 (AL2023)"><meta itemprop=description content="Learn how to migrate your EKS worker nodes from Amazon Linux 2 (AL2) to Amazon Linux 2023 (AL2023), set up custom launch templates, and handle IMDSv2 and IRSA configurations."><meta itemprop=datePublished content="2025-11-11T10:00:00+05:30"><meta itemprop=dateModified content="2025-11-11T10:00:00+05:30"><meta itemprop=wordCount content="538"><meta itemprop=keywords content="EKS,Amazon Linux 2023,AL2023,IRSA,IMDSv2,AWS Launch Template,EKS Migration"><meta name=twitter:card content="summary"><meta name=twitter:title content="Migrating EKS Nodes from Amazon Linux 2 to Amazon Linux 2023 (AL2023)"><meta name=twitter:description content="Learn how to migrate your EKS worker nodes from Amazon Linux 2 (AL2) to Amazon Linux 2023 (AL2023), set up custom launch templates, and handle IMDSv2 and IRSA configurations."></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">Saurabh Cloud Page</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Posts</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Migrating EKS Nodes from Amazon Linux 2 to Amazon Linux 2023 (AL2023)</h1><time class="f6 mv4 dib tracked" datetime=2025-11-11T10:00:00+05:30>November 11, 2025</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=-aws-launch-template-with-amazon-linux-2023-standard-eks-images>üöÄ AWS Launch Template with Amazon Linux 2023 Standard EKS Images</h2><p>With <strong>Amazon EKS 1.33 and later</strong>, AWS has deprecated <strong>Amazon Linux 2 (AL2)</strong> EKS AMIs and made <strong>Amazon Linux 2023 (AL2023)</strong> the <strong>default and mandatory base image</strong>.<br>This means all new EKS clusters and node groups must use AL2023 moving forward.</p><p>If you‚Äôre still using AL2-based worker nodes, now is the time to <strong>migrate to AL2023</strong> and reschedule your workloads to new nodes.</p><p>This guide walks you through the migration process, highlights <strong>important configuration changes</strong>, and shares <strong>real-world fixes</strong> for issues we faced during the transition.</p><hr><h2 id=-key-features-of-amazon-linux-2023-al2023>‚öôÔ∏è Key Features of Amazon Linux 2023 (AL2023)</h2><h3 id=1-imdsv2-by-default>1. IMDSv2 by Default</h3><p>AL2023 enables <strong>Instance Metadata Service v2 (IMDSv2)</strong> ‚Äî a more secure, token-based version of IMDS that prevents SSRF (Server-Side Request Forgery) attacks and unauthorized metadata access.</p><p>Unlike AL2, <strong>pods in AL2023 nodes cannot directly access the EC2 instance‚Äôs IAM role credentials</strong> via IMDS.</p><p>This introduces a stronger security boundary:</p><ul><li>Pods <strong>cannot use node IAM roles directly</strong>.</li><li>AWS recommends using <strong>IRSA (IAM Role for Service Account)</strong> for pod-level IAM permissions.</li></ul><hr><h2 id=why-you-must-use-irsa-iam-roles-for-service-accounts>Why You Must Use IRSA (IAM Roles for Service Accounts)</h2><p>With AL2023:</p><ul><li>The EC2 IAM role assigned to the node is no longer accessible from pods.</li><li>The recommended approach is to <strong>assign IAM roles directly to pods</strong> via <strong>IRSA</strong>.</li></ul><p>This ensures <strong>least privilege</strong> and isolates permissions per pod.</p><p>Here‚Äôs how to annotate a service account with an IAM role:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl annotate serviceaccount &lt;SERVICE_ACCOUNT_NAME&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -n &lt;NAMESPACE&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  eks.amazonaws.com/role-arn<span style=color:#f92672>=</span>arn:aws:iam::&lt;AWS_ACCOUNT_ID&gt;:role/&lt;IAM_ROLE_NAME&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --overwrite
</span></span></code></pre></div><p>Then, restart your pods to pick up the new IAM role.</p><p>üí° Example:
If your pod needs access to an S3 bucket, attach an IAM role with the required S3 permissions to the service account.
Add this service account to the IAM role‚Äôs trust policy in AWS IAM.</p><p>‚öôÔ∏è Recommended Configuration ‚Äî Hop Count and Launch Templates</p><p>AWS recommends setting IMDS hop count = 2 for EKS nodes running AL2023.
To do this, you must use a custom launch template when creating your EKS node group.</p><p>üßæ You can also use the launch template to customize:</p><p>Storage type (gp2 ‚Üí gp3)</p><p>Encryption settings</p><p>Network and security configurations</p><p>üß± Example: Custom Launch Template with User Data</p><p>During our migration, we faced an issue where the EKS node group didn‚Äôt become active and threw the error:</p><p>failed to join the kubectl cluster</p><p>The fix was to include a bootstrap user_data script inside the launch template.
This ensures that the node registers properly with the EKS control plane during provisioning.</p><h2 id=below-is-the-minimum-required-user_data-content>Below is the minimum required user_data content:</h2><p>MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="//"</p><p>&ndash;//
Content-Type: application/node.eks.aws</p><hr><h2 id=heading>apiVersion: node.eks.aws/v1alpha1
kind: NodeConfig
spec:
cluster:
apiServerEndpoint: <a href=https://88C1DFBF289C6EXXXXXXE6F2D95A00.gr7.ap-south-1.eks.amazonaws.com>https://88C1DFBF289C6EXXXXXXE6F2D95A00.gr7.ap-south-1.eks.amazonaws.com</a>
certificateAuthority: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS
cidr: 172.20.0.0/17
name: eks-cdp1-p-ap-south-1-1
&ndash;//&ndash;</h2><p>Once this template is configured, create or update your EKS managed node group using it.</p><p>Now scale up your new AL2023 node pool to the requried count once all the nodes are Ready scale down the AL2 node pool.</p><p>Summary of actions:</p><p>Create a custom launch template with hop count 2 and bootstrap user_data.</p><p>Use AL2023 standard EKS AMI.</p><p>Migrate workloads and ensure pods use IRSA-based service accounts.</p><p>Decommission AL2 node groups after validation.</p><p>If you encounter issues or need help debugging EKS node initialization, feel free to reach out at
üìß <a href=mailto:hello.saurabhoncloud@gmail.com>hello.saurabhoncloud@gmail.com</a></p><ul class=pa0><li class="list di"><a href=/tags/aws/ class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">AWS</a></li><li class="list di"><a href=/tags/eks/ class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">EKS</a></li><li class="list di"><a href=/tags/devops/ class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">DevOps</a></li><li class="list di"><a href=/tags/amazon-linux-2023/ class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">Amazon Linux 2023</a></li><li class="list di"><a href=/tags/kubernetes/ class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">Kubernetes</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/aws-invalid-credentials-issue/>AWS Invalid Credentials Issue ‚Äî Time Sync Resolution</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://saurabhoncloud.com/>&copy; Saurabh Cloud Page 2026</a><div><div class=ananke-socials></div></div></div></footer></body></html>